# vulnz cli

## Caching the NVD CVE Data

The vulnz cli can create a cache of the NVD CVE data obtained from the API. The
data is stored in `json` files with the data saved in the traditional yearly groupings
starting with 2002 and going to the current year. In addition, a `cache.properties` is
created that contains the `lastModifiedDate` datetime as well as the prefix used for the
generated JSON files (by default `nvdcve-` is used). Additionally, a `modified` JSON file
is created that will hold the CVEs that have been modified in the last 7 days. After running
the below command you will end up with a directory with:

- `cache.properties`
- `nvdcve-modified.json.gz`
- `nvdcve-modified.meta`
- `nvdcve-2002.json.gz`
- `nvdcve-2002.meta`
- `nvdcve-2003.json.gz`
- `nvdcve-2003.meta`
- ...
- `nvdcve-2024.json.gz`
- `nvdcve-2024.meta`

## Docker image

### Configuration

There are a couple of ENV vars

- `NVD_API_KEY`: define your API key
- `DELAY`: override the delay - given in milliseconds. If you do not set an API KEY, the delay will be `10000`

# Construir cliente vulnz
```bash
export VULNZ_VERSION=6.1.7
./gradlew vulnz:build -Pversion=$VULNZ_VERSION
```

# Construir imagen docker
```bash
docker build vulnz/ -t $(REGISTRY_DEV)/vulnz:$VULNZ_VERSION --build-arg BUILD_VERSION=$VULNZ_VERSION --build-arg nvm_api_key=$(NVD_API_KEY) \
                                                                --build-arg cache_date="$(date)"
```

# Docker push a docker registry
```bash
docker push $(REGISTRY_DEV)/vulnz:$VULNZ_VERSION
```

# Para ejecutar el servicio de apache publicando el data de vulnz por http desde el pipeline de los proyectos
```bash
docker run -d --name vulnz -p 8080:80 $(REGISTRY_DEV)/vulnz:$VULNZ_VERSION
```